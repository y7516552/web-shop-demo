"use strict";(self["webpackChunkweb_shop_demo"]=self["webpackChunkweb_shop_demo"]||[]).push([[512],{4101:function(e,t,o){o.r(t),o.d(t,{default:function(){return I}});var l=o(3396),a=o(9242),s=o(7139);const n={class:"text-end mt-5"},d={class:"container"},i={class:"table mt-4"},c=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"優惠名稱"),(0,l._)("th",null,"折扣"),(0,l._)("th",null,"到期日"),(0,l._)("th",null,"是否啟用"),(0,l._)("th",null,"編輯")])],-1),u={key:0,class:"text-success"},r=(0,l._)("strong",null,"啟用",-1),h=[r],p={key:1,class:"text-muted"},m=(0,l._)("strong",null,"未啟用",-1),_=[m],b={class:"btn-group d-flex align-items-center"},v=["onClick"],g=["onClick"];function V(e,t,o,r,m,V){const f=(0,l.up)("loading-component"),M=(0,l.up)("pagination-bar"),w=(0,l.up)("voucher-modal"),y=(0,l.up)("del-modal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(f,{active:m.isLoading},null,8,["active"]),(0,l._)("div",n,[(0,l._)("button",{class:"btn btn-primary mt-5",type:"button",onClick:t[0]||(t[0]=(0,a.iM)((e=>V.openModal(!0)),["prevent"]))},"新增優惠券")]),(0,l._)("div",d,[(0,l._)("table",i,[c,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.vouchers,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",null,(0,s.zw)(t.title),1),(0,l._)("td",null,(0,s.zw)(t.percent)+" %",1),(0,l._)("td",null,(0,s.zw)(e.$filters.date(t.due_date)),1),(0,l._)("td",null,[t.is_enabled?((0,l.wg)(),(0,l.iD)("span",u,h)):((0,l.wg)(),(0,l.iD)("span",p,_))]),(0,l._)("td",null,[(0,l._)("div",b,[(0,l._)("button",{class:"btn btn-primary",onClick:(0,a.iM)((e=>V.openModal(!1,t)),["prevent"])},"編輯",8,v),(0,l._)("button",{class:"btn btn-danger",onClick:(0,a.iM)((e=>V.openModal(!1,t,"delete")),["prevent"])},"刪除",8,g)])])])))),128))])])]),(0,l.Wm)(M,{pages:m.pagination,onEmitPages:V.getVouchers},null,8,["pages","onEmitPages"]),(0,l.Wm)(w,{ref:"voucherModal",voucher:m.tempVoucher,onUpdateVoucher:V.updateVoucher},null,8,["voucher","onUpdateVoucher"]),(0,l.Wm)(y,{ref:"delModal",item:m.tempVoucher,onDeleteVoucher:V.deleteVoucher},null,8,["item","onDeleteVoucher"])],64)}var f=o(9637);const M={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},w={class:"modal-dialog modal-xl",role:"document"},y={class:"modal-content border-0"},k=(0,l._)("div",{class:"modal-header bg-dark text-white"},[(0,l._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,l._)("span",null,"新增優惠券")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),x={class:"modal-body"},$={class:"row"},C={class:"mb-3"},D=(0,l._)("label",{for:"title",class:"form-label"},"優惠券標題",-1),U=(0,l._)("hr",null,null,-1),L={class:"mb-3"},Z=(0,l._)("label",{for:"percent",class:"form-label"},"折扣%",-1),P={class:"mb-3"},W=(0,l._)("label",{for:"due_date",class:"form-label"},"到期日",-1),z={class:"mb-3"},N=(0,l._)("label",{for:"code",class:"form-label"},"優惠代碼",-1),j={class:"mb-3"},q={class:"form-check"},E=(0,l._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),H={class:"modal-footer"};function S(e,t,o,s,n,d){return(0,l.wg)(),(0,l.iD)("div",M,[(0,l._)("div",w,[(0,l._)("div",y,[k,(0,l._)("div",x,[(0,l._)("div",$,[(0,l._)("div",C,[D,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題",required:"","onUpdate:modelValue":t[0]||(t[0]=e=>n.tempVoucher.title=e)},null,512),[[a.nr,n.tempVoucher.title]])]),U,(0,l._)("div",L,[Z,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"percent",placeholder:"請輸入折扣%","onUpdate:modelValue":t[1]||(t[1]=e=>n.tempVoucher.percent=e)},null,512),[[a.nr,n.tempVoucher.percent]])]),(0,l._)("div",P,[W,(0,l.wy)((0,l._)("input",{type:"date",class:"form-control",id:"due_date",placeholder:"請輸入優惠券到期日","onUpdate:modelValue":t[2]||(t[2]=e=>this.due_date=e)},null,512),[[a.nr,this.due_date]])]),(0,l._)("div",z,[N,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"code",placeholder:"請輸入優惠券代碼",required:"","onUpdate:modelValue":t[3]||(t[3]=e=>n.tempVoucher.code=e)},null,512),[[a.nr,n.tempVoucher.code]])]),(0,l._)("div",j,[(0,l._)("div",q,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":t[4]||(t[4]=e=>n.tempVoucher.is_enabled=e)},null,512),[[a.e8,n.tempVoucher.is_enabled]]),E])])])]),(0,l._)("div",H,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:t[5]||(t[5]=(...t)=>e.hideModal&&e.hideModal(...t))},"取消 "),(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=(0,a.iM)((t=>e.$emit("update-voucher",n.tempVoucher)),["prevent"]))},"確認")])])])],512)}var Y=o(1339),B={props:{voucher:{type:Object,default(){return{}}}},watch:{voucher(){this.tempVoucher=this.voucher,this.voucher.percent||(this.tempVoucher.percent=100),this.voucher.is_enabled||(this.tempVoucher.is_enabled=0)},due_date(){const e=this.due_date;this.tempVoucher.due_date=Math.floor(new Date(e).getTime()/1e3)}},data(){return{modal:{},tempVoucher:{},due_date:""}},mixins:[Y.Z]},K=o(89);const O=(0,K.Z)(B,[["render",S]]);var T=O,A=o(8991),F={data(){return{vouchers:[],tempVoucher:{},pagination:{},isNew:!1,isLoading:!1}},components:{PaginationBar:f.Z,VoucherModal:T,DelModal:A.Z},inject:["emitter"],methods:{getVouchers(e=1){const t=`https://vue3-course-api.hexschool.io/api/steven-vue3-demo/admin/coupons/?page=${e}`;this.isLoading=!0,this.$http.get(t).then((e=>{console.log(e.data.coupons),this.isLoading=!1,e.data.success&&(this.vouchers=e.data.coupons,this.pagination=e.data.pagination)}))},openModal(e,t,o){this.tempVoucher=e?{}:{...t};let l=this.$refs.voucherModal;"delete"===o&&(l=this.$refs.delModal),l.showModal(),this.isNew=e},updateVoucher(e){this.tempProduct=e;let t="https://vue3-course-api.hexschool.io/api/steven-vue3-demo/admin/coupon",o="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/api/steven-vue3-demo/admin/coupon/${e.id}`,o="put");const l=this.$refs.voucherModal;this.$http[o](t,{data:this.tempVoucher}).then((e=>{this.getVouchers(),this.$httpMessageState(e,"更新優惠券"),l.hideModal()}))},deleteVoucher(e){this.tempVoucher=e;const t=`https://vue3-course-api.hexschool.io/api/steven-vue3-demo/admin/coupon/${e.id}`,o=this.$refs.delModal;this.$http.delete(t).then((e=>{this.$httpMessageState(e,"刪除優惠券"),o.hideModal(),this.getVouchers()}))}},created(){this.getVouchers()}};const G=(0,K.Z)(F,[["render",V]]);var I=G}}]);
//# sourceMappingURL=512.48d2c188.js.map