"use strict";(self["webpackChunkweb_shop_demo"]=self["webpackChunkweb_shop_demo"]||[]).push([[101],{8991:function(e,t,a){a.d(t,{Z:function(){return H}});var l=a(3396),o=a(7139),i=a(9242);const s={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},n={class:"modal-dialog modal-sm",role:"document"},r={class:"modal-content border-0"},d={class:"modal-header bg-danger text-white"},c={class:"modal-title",id:"exampleModalLabel"},u={key:0},p={key:1},h={key:2},m={key:3},b=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),g={class:"modal-body"},_={key:0},v=(0,l.Uk)("是否要刪除文章"),y={class:"text-danger"},w=(0,l.Uk)("?"),k={key:1},f=(0,l.Uk)("是否要刪除優惠券"),V={class:"text-danger"},M=(0,l.Uk)("?"),x={key:2},D=(0,l.Uk)("是否要刪除產品"),C={class:"text-danger"},$=(0,l.Uk)("?"),U={key:3},P=(0,l.Uk)("是否要刪除訂單"),z={class:"text-danger"},Z=(0,l.Uk)("?"),L={class:"modal-footer"};function O(e,t,a,O,j,N){return(0,l.wg)(),(0,l.iD)("div",s,[(0,l._)("div",n,[(0,l._)("div",r,[(0,l._)("div",d,[(0,l._)("h5",c,[a.item.author?((0,l.wg)(),(0,l.iD)("span",u,"刪除文章 "+(0,o.zw)(a.item.title),1)):a.item.code?((0,l.wg)(),(0,l.iD)("span",p,"刪除優惠券 "+(0,o.zw)(a.item.title),1)):a.item.category?((0,l.wg)(),(0,l.iD)("span",h,"刪除產品 "+(0,o.zw)(a.item.title),1)):((0,l.wg)(),(0,l.iD)("span",m,"刪除訂單 "+(0,o.zw)(a.item.id),1))]),b]),(0,l._)("div",g,[a.item.author?((0,l.wg)(),(0,l.iD)("span",_,[v,(0,l._)("strong",y,(0,o.zw)(a.item.title),1),w])):a.item.code?((0,l.wg)(),(0,l.iD)("span",k,[f,(0,l._)("strong",V,(0,o.zw)(a.item.title),1),M])):a.item.category?((0,l.wg)(),(0,l.iD)("span",x,[D,(0,l._)("strong",C,(0,o.zw)(a.item.title),1),$])):((0,l.wg)(),(0,l.iD)("span",U,[P,(0,l._)("strong",z,(0,o.zw)(a.item.title),1),Z]))]),(0,l._)("div",L,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:t[0]||(t[0]=(0,i.iM)(((...t)=>e.hideModal&&e.hideModal(...t)),["prevent"]))},"取消 "),a.item.author?((0,l.wg)(),(0,l.iD)("button",{key:0,type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=(0,i.iM)((t=>e.$emit("delete-article",j.tempArticle)),["prevent"]))},"確認")):a.item.code?((0,l.wg)(),(0,l.iD)("button",{key:1,type:"button",class:"btn btn-primary",onClick:t[2]||(t[2]=(0,i.iM)((t=>e.$emit("delete-voucher",j.tempVoucher)),["prevent"]))},"確認")):a.item.category?((0,l.wg)(),(0,l.iD)("button",{key:2,type:"button",class:"btn btn-primary",onClick:t[3]||(t[3]=(0,i.iM)((t=>e.$emit("delete-product",j.tempProduct)),["prevent"]))},"確認")):((0,l.wg)(),(0,l.iD)("button",{key:3,type:"button",class:"btn btn-primary",onClick:t[4]||(t[4]=(0,i.iM)((t=>e.$emit("delete-order",j.tempOrder)),["prevent"]))},"確認"))])])])],512)}var j=a(1339),N={props:{item:{type:Object,default(){return{}}}},watch:{item(){this.item.author?this.tempArticle=this.item:this.item.code?this.tempVoucher=this.item:this.item.category?this.tempProduct=this.item:this.tempOrder=this.item}},data(){return{modal:{},tempProduct:{},tempOrder:{},tempVoucher:{},tempArticle:{}}},mixins:[j.Z]},W=a(89);const A=(0,W.Z)(N,[["render",O]]);var H=A},9637:function(e,t,a){a.d(t,{Z:function(){return _}});var l=a(3396),o=a(7139),i=a(9242);const s={"aria-label":"Page navigation example"},n={class:"pagination justify-content-center"},r=(0,l._)("span",{"aria-hidden":"true"},"«",-1),d=[r],c=["onClick"],u=(0,l._)("span",{"aria-hidden":"true"},"»",-1),p=[u];function h(e,t,a,r,u,h){return(0,l.wg)(),(0,l.iD)("nav",s,[(0,l._)("ul",n,[(0,l._)("li",{class:(0,o.C_)(["page-item",{disabled:!a.pages.has_pre}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,i.iM)((e=>h.changePage(-1)),["prevent"]))},d)],2),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pages.total_pages,(e=>((0,l.wg)(),(0,l.iD)("li",{class:(0,o.C_)(["page-item",{active:e===a.pages.current_page}]),key:e},[(0,l._)("a",{class:"page-link",href:"#",onClick:(0,i.iM)((t=>h.updatePages(e)),["prevent"])},(0,o.zw)(e),9,c)],2)))),128)),(0,l._)("li",{class:(0,o.C_)(["page-item",{disabled:!a.pages.has_next}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,i.iM)((e=>h.changePage(1)),["prevent"]))},p)],2)])])}var m={props:["pages"],methods:{updatePages(e){this.$emit("emit-pages",e)},changePage(e){this.$emit("emit-pages",this.pages.current_page+e)}}},b=a(89);const g=(0,b.Z)(m,[["render",h]]);var _=g},4101:function(e,t,a){a.r(t),a.d(t,{default:function(){return I}});var l=a(3396),o=a(9242),i=a(7139);const s={class:"text-end mt-5"},n={class:"container"},r={class:"table mt-4"},d=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"優惠名稱"),(0,l._)("th",null,"折扣"),(0,l._)("th",null,"到期日"),(0,l._)("th",null,"是否啟用"),(0,l._)("th",null,"編輯")])],-1),c={key:0,class:"text-success"},u=(0,l._)("strong",null,"啟用",-1),p=[u],h={key:1,class:"text-muted"},m=(0,l._)("strong",null,"未啟用",-1),b=[m],g={class:"btn-group d-flex align-items-center"},_=["onClick"],v=["onClick"];function y(e,t,a,u,m,y){const w=(0,l.up)("loading-component"),k=(0,l.up)("pagination-bar"),f=(0,l.up)("voucher-modal"),V=(0,l.up)("del-modal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(w,{active:m.isLoading},null,8,["active"]),(0,l._)("div",s,[(0,l._)("button",{class:"btn btn-primary mt-5",type:"button",onClick:t[0]||(t[0]=(0,o.iM)((e=>y.openModal(!0)),["prevent"]))},"新增優惠券")]),(0,l._)("div",n,[(0,l._)("table",r,[d,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.vouchers,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",null,(0,i.zw)(t.title),1),(0,l._)("td",null,(0,i.zw)(t.percent)+" %",1),(0,l._)("td",null,(0,i.zw)(e.$filters.date(t.due_date)),1),(0,l._)("td",null,[t.is_enabled?((0,l.wg)(),(0,l.iD)("span",c,p)):((0,l.wg)(),(0,l.iD)("span",h,b))]),(0,l._)("td",null,[(0,l._)("div",g,[(0,l._)("button",{class:"btn btn-primary",onClick:(0,o.iM)((e=>y.openModal(!1,t)),["prevent"])},"編輯",8,_),(0,l._)("button",{class:"btn btn-danger",onClick:(0,o.iM)((e=>y.openModal(!1,t,"delete")),["prevent"])},"刪除",8,v)])])])))),128))])])]),(0,l.Wm)(k,{pages:m.pagination,onEmitPages:y.getVouchers},null,8,["pages","onEmitPages"]),(0,l.Wm)(f,{ref:"voucherModal",voucher:m.tempVoucher,onUpdateVoucher:y.updateVoucher},null,8,["voucher","onUpdateVoucher"]),(0,l.Wm)(V,{ref:"delModal",item:m.tempVoucher,onDeleteVoucher:y.deleteVoucher},null,8,["item","onDeleteVoucher"])],64)}var w=a(9637);const k={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},f={class:"modal-dialog modal-xl",role:"document"},V={class:"modal-content border-0"},M=(0,l._)("div",{class:"modal-header bg-dark text-white"},[(0,l._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,l._)("span",null,"新增優惠券")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),x={class:"modal-body"},D={class:"row"},C={class:"mb-3"},$=(0,l._)("label",{for:"title",class:"form-label"},"優惠券標題",-1),U=(0,l._)("hr",null,null,-1),P={class:"mb-3"},z=(0,l._)("label",{for:"percent",class:"form-label"},"折扣%",-1),Z={class:"mb-3"},L=(0,l._)("label",{for:"due_date",class:"form-label"},"到期日",-1),O={class:"mb-3"},j=(0,l._)("label",{for:"code",class:"form-label"},"優惠代碼",-1),N={class:"mb-3"},W={class:"form-check"},A=(0,l._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),H={class:"modal-footer"};function Y(e,t,a,i,s,n){return(0,l.wg)(),(0,l.iD)("div",k,[(0,l._)("div",f,[(0,l._)("div",V,[M,(0,l._)("div",x,[(0,l._)("div",D,[(0,l._)("div",C,[$,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題",required:"","onUpdate:modelValue":t[0]||(t[0]=e=>s.tempVoucher.title=e)},null,512),[[o.nr,s.tempVoucher.title]])]),U,(0,l._)("div",P,[z,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"percent",placeholder:"請輸入折扣%","onUpdate:modelValue":t[1]||(t[1]=e=>s.tempVoucher.percent=e)},null,512),[[o.nr,s.tempVoucher.percent]])]),(0,l._)("div",Z,[L,(0,l.wy)((0,l._)("input",{type:"date",class:"form-control",id:"due_date",placeholder:"請輸入優惠券到期日","onUpdate:modelValue":t[2]||(t[2]=e=>this.due_date=e)},null,512),[[o.nr,this.due_date]])]),(0,l._)("div",O,[j,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"code",placeholder:"請輸入優惠券代碼",required:"","onUpdate:modelValue":t[3]||(t[3]=e=>s.tempVoucher.code=e)},null,512),[[o.nr,s.tempVoucher.code]])]),(0,l._)("div",N,[(0,l._)("div",W,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":t[4]||(t[4]=e=>s.tempVoucher.is_enabled=e)},null,512),[[o.e8,s.tempVoucher.is_enabled]]),A])])])]),(0,l._)("div",H,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:t[5]||(t[5]=(...t)=>e.hideModal&&e.hideModal(...t))},"取消 "),(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=(0,o.iM)((t=>e.$emit("update-voucher",s.tempVoucher)),["prevent"]))},"確認")])])])],512)}var q=a(1339),E={props:{voucher:{type:Object,default(){return{}}}},watch:{voucher(){this.tempVoucher=this.voucher,this.voucher.percent||(this.tempVoucher.percent=100),this.voucher.is_enabled||(this.tempVoucher.is_enabled=0)},due_date(){const e=this.due_date;this.tempVoucher.due_date=Math.floor(new Date(e).getTime()/1e3)}},data(){return{modal:{},tempVoucher:{},due_date:""}},mixins:[q.Z]},K=a(89);const S=(0,K.Z)(E,[["render",Y]]);var B=S,T=a(8991),F={data(){return{vouchers:[],tempVoucher:{},pagination:{},isNew:!1,isLoading:!1}},components:{PaginationBar:w.Z,VoucherModal:B,DelModal:T.Z},inject:["emitter"],methods:{getVouchers(e=1){const t=`https://vue3-course-api.hexschool.io/api/steven-vue3-demo/admin/coupons/?page=${e}`;this.isLoading=!0,this.$http.get(t).then((e=>{console.log(e.data.coupons),this.isLoading=!1,e.data.success&&(this.vouchers=e.data.coupons,this.pagination=e.data.pagination)}))},openModal(e,t,a){this.tempVoucher=e?{}:{...t};let l=this.$refs.voucherModal;"delete"===a&&(l=this.$refs.delModal),l.showModal(),this.isNew=e},updateVoucher(e){this.tempProduct=e;let t="https://vue3-course-api.hexschool.io/api/steven-vue3-demo/admin/coupon",a="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/api/steven-vue3-demo/admin/coupon/${e.id}`,a="put");const l=this.$refs.voucherModal;this.$http[a](t,{data:this.tempVoucher}).then((e=>{this.getVouchers(),this.$httpMessageState(e,"更新優惠券"),l.hideModal()}))},deleteVoucher(e){this.tempVoucher=e;const t=`https://vue3-course-api.hexschool.io/api/steven-vue3-demo/admin/coupon/${e.id}`,a=this.$refs.delModal;this.$http.delete(t).then((e=>{this.$httpMessageState(e,"刪除優惠券"),a.hideModal(),this.getVouchers()}))}},created(){this.getVouchers()}};const G=(0,K.Z)(F,[["render",y]]);var I=G}}]);
//# sourceMappingURL=101.c5fee903.js.map